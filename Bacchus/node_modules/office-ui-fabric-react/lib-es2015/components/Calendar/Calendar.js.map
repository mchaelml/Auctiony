{"version":3,"file":"Calendar.js","sourceRoot":"../src/","sources":["components/Calendar/Calendar.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,OAAO,EAAE,SAAS,EAAE,eAAe,EAAE,aAAa,EAAE,MAAM,uCAAuC,CAAC;AAClG,OAAO,EAAE,WAAW,EAAgB,MAAM,eAAe,CAAC;AAC1D,OAAO,EAAE,aAAa,EAAkB,MAAM,iBAAiB,CAAC;AAChE,OAAO,EAAE,YAAY,EAAE,iBAAiB,EAAE,MAAM,mCAAmC,CAAC;AACpF,OAAO,EACL,GAAG,EACH,aAAa,EAEb,SAAS,EACV,MAAM,iBAAiB,CAAC;AACzB,OAAO,KAAK,YAAY,MAAM,iBAAiB,CAAC;AAChD,IAAM,MAAM,GAAQ,YAAY,CAAC;AAEjC,IAAM,SAAS,GAAG,IAAI,CAAC;AACvB,IAAM,UAAU,GAAG,MAAM,CAAC;AAC1B,IAAM,WAAW,GAAyB;IACxC,cAAc,EAAE,SAAS;IACzB,eAAe,EAAE,UAAU;CAC5B,CAAC;AACF,IAAM,mBAAmB,GAAgB;IACvC,SAAS,CAAC,MAAM;IAChB,SAAS,CAAC,OAAO;IACjB,SAAS,CAAC,SAAS;IACnB,SAAS,CAAC,QAAQ;IAClB,SAAS,CAAC,MAAM;CACjB,CAAC;AAEF,IAAM,0BAA0B,GAAiC;IAC/D,kBAAkB,EAAE,UAAC,IAAU,EAAE,OAAyB,IAAK,OAAA,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,EAApF,CAAoF;IACnJ,eAAe,EAAE,UAAC,IAAU,EAAE,OAAyB,IAAK,OAAA,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,EAA5D,CAA4D;IACxH,SAAS,EAAE,UAAC,IAAU,IAAK,OAAA,IAAI,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE,EAAzB,CAAyB;IACpD,UAAU,EAAE,UAAC,IAAU,IAAK,OAAA,IAAI,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,EAA7B,CAA6B;CAC1D,CAAC;AAgBF;IAA8B,oCAA6C;IA6BzE,kBAAY,KAAqB;QAAjC,YACE,kBAAM,KAAK,CAAC,SAab;QAnBO,gBAAU,GAAG,SAAS,EAAgB,CAAC;QACvC,kBAAY,GAAG,SAAS,EAAkB,CAAC;QA2I3C,kBAAY,GAAG,UAAC,IAAU;YAChC,KAAI,CAAC,QAAQ,CAAC;gBACZ,aAAa,EAAE,IAAI;aACpB,CAAC,CAAC;QACL,CAAC,CAAA;QAEO,qBAAe,GAAG,UAAC,IAAU,EAAE,mBAA4B;YACjE,IAAI,KAAI,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,mBAAmB,CAAC,EAAE;gBAC7F,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBACxB,KAAI,CAAC,cAAc,GAAG,mBAAmB,CAAC;aAC3C;iBAAM;gBACL,6DAA6D;gBAC7D,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;aAC1B;QACH,CAAC,CAAA;QAEO,mBAAa,GAAG,UAAC,IAAU,EAAE,sBAA+B;YAC1D,IAAA,uCAAY,CAAgB;YAEpC,KAAI,CAAC,QAAQ,CAAC;gBACZ,YAAY,EAAE,IAAI;aACnB,CAAC,CAAC;YAEH,IAAI,YAAY,EAAE;gBAChB,YAAY,CAAC,IAAI,EAAE,sBAAsB,CAAC,CAAC;aAC5C;QACH,CAAC,CAAA;QAEO,qBAAe,GAAG,UAAC,KAAc;YACvC,KAAI,CAAC,QAAQ,CAAC;gBACZ,kBAAkB,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,kBAAkB;gBAClD,oBAAoB,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,oBAAoB;aACvD,CAAC,CAAC;YAEH,IAAI,KAAK,EAAE;gBACT,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC;aAC5B;QACH,CAAC,CAAA;QAEO,kBAAY,GAAG;YACf,IAAA,gBAAmE,EAAjE,gCAAa,EAAE,kCAAc,EAAE,gBAAK,EAAE,8BAAY,CAAgB;YAE1E,IAAM,KAAK,GAAG,iBAAiB,CAAC,KAAM,EAAE,aAAc,EAAE,cAAe,EAAE,YAAa,CAAC,CAAC;YAExF,KAAI,CAAC,aAAa,CAAC,KAAM,EAAE,KAAK,CAAC,CAAC;QACpC,CAAC,CAAA;QAEO,yBAAmB,GAAG,UAAC,EAAoC;YACjE,IAAI,EAAE,CAAC,KAAK,mBAAmB,EAAE;gBAC/B,EAAE,CAAC,cAAc,EAAE,CAAC;gBACpB,KAAI,CAAC,YAAY,EAAE,CAAC;aACrB;iBAAM,IAAI,EAAE,CAAC,KAAK,gBAAiB,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;gBACpD,IAAI,KAAI,CAAC,KAAK,CAAC,SAAS,EAAE;oBACxB,EAAE,CAAC,eAAe,EAAE,CAAC;oBACrB,EAAE,CAAC,cAAc,EAAE,CAAC;oBACpB,KAAI,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;iBACxB;aACF;QACH,CAAC,CAAA;QAEO,+BAAyB,GAAG,UAAC,EAAoC;YACvE,QAAQ,EAAE,CAAC,KAAK,EAAE;gBAChB;oBACE,EAAE,CAAC,cAAc,EAAE,CAAC;oBACpB,MAAM;gBAER;oBACE,EAAE,CAAC,cAAc,EAAE,CAAC;oBACpB,MAAM;gBAER;oBACE,KAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;oBACvB,MAAM;gBAER;oBACE,MAAM;aACT;QACH,CAAC,CAAA;QAEO,mBAAa,GAAG,UAAC,EAAoC;YAC3D,IAAI,KAAI,CAAC,KAAK,CAAC,SAAS,EAAE;gBACxB,KAAI,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;aACxB;QACH,CAAC,CAAA;QAxNC,IAAM,WAAW,GAAG,KAAK,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,IAAI,IAAI,EAAE,CAAC,CAAC;QAE7G,KAAI,CAAC,KAAK,GAAG;YACX,YAAY,EAAE,WAAW;YACzB,aAAa,EAAE,WAAW;YAE1B,qLAAqL;YACrL,oBAAoB,EAAE,KAAI,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,oBAAoB;YACnG,kBAAkB,EAAE,KAAI,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,kBAAkB;SAC/F,CAAC;QAEF,KAAI,CAAC,cAAc,GAAG,KAAK,CAAC;;IAC9B,CAAC;IAEM,4CAAyB,GAAhC,UAAiC,SAAyB;QAChD,IAAA,2DAAuB,EAAE,uBAAK,EAAE,oBAAkB,EAAlB,uCAAkB,CAAe;QAEzE,0FAA0F;QAC1F,kFAAkF;QAClF,IAAM,qBAAqB,GAAG,CAAC,uBAAuB,IAAI,CAAC,YAAY,CAAC,KAAM,EAAE,IAAI,CAAC,KAAK,CAAC,KAAM,CAAC,CAAC,CAAC;QACpG,IAAI,qBAAqB,EAAE;YACzB,IAAI,CAAC,QAAQ,CAAC;gBACZ,aAAa,EAAE,KAAK;aACrB,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,QAAQ,CAAC;YACZ,YAAY,EAAE,KAAK,IAAI,KAAK;SAC7B,CAAC,CAAC;IACL,CAAC;IAEM,qCAAkB,GAAzB;QACE,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,0CAA0C;YAC1C,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE;gBAC3B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;aACjC;iBAAM,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE;gBACpC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;aACnC;YACD,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;SAC7B;IACH,CAAC;IAEM,yBAAM,GAAb;QACE,IAAM,SAAS,GAAG,eAAe,CAAC;QAC5B,IAAA,eAAsN,EAApN,kCAAc,EAAE,gCAAa,EAAE,oBAAO,EAAE,sDAAwB,EAAE,oDAAuB,EAAE,gCAAa,EAAE,gDAAqB,EAAE,kDAAsB,EAAE,oCAAe,EAAE,oBAAO,EAAE,oBAAO,EAAE,wBAAS,CAAgB;QACvN,IAAA,eAAsF,EAApF,8BAAY,EAAE,gCAAa,EAAE,8CAAoB,EAAE,0CAAkB,CAAgB;QAC7F,IAAM,cAAc,GAAG,wBAAwB,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC;QACnF,IAAM,eAAe,GAAG,CAAC,wBAAwB,IAAI,CAAC,kBAAkB,CAAC;QACzE,IAAM,mBAAmB,GAAG,wBAAwB,IAAI,aAAa,CAAC;QAEtE,OAAO,CACL,6BAAK,SAAS,EAAG,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,EAAE,SAAS,CAAC,EAAG,IAAI,EAAC,aAAa;YAC1E,6BACE,SAAS,EAAG,GAAG,CACb,iFAAiF,EACjF,MAAM,CAAC,MAAM,EACb,MAAM,CAAC,cAAc,EACrB,MAAM,CAAC,eAAe,EACtB,oBAAoB,IAAI,CAAC,mCAAmC,GAAG,MAAM,CAAC,kBAAkB,CAAC,EACzF,oBAAoB,IAAI,kBAAkB,IAAI,CAAC,gCAAgC,GAAG,MAAM,CAAC,eAAe,CAAC,EACzG,eAAe,IAAI,CAAC,gCAAgC,GAAG,MAAM,CAAC,eAAe,CAAC,EAC9E,wBAAwB,IAAI,CAAC,qCAAqC,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAClG;gBAED,6BAAK,SAAS,EAAG,GAAG,CAAC,uCAAuC,EAAE,MAAM,CAAC,MAAM,EAAE,mBAAmB,IAAI,MAAM,CAAC,gBAAgB,CAAC,EAAG,SAAS,EAAG,IAAI,CAAC,yBAAyB;oBACvK,6BAAK,SAAS,EAAG,GAAG,CAAC,qBAAqB,EAAE,MAAM,CAAC,KAAK,CAAC;wBACvD,6BAAK,SAAS,EAAG,GAAG,CAAC,oBAAoB,EAAE,MAAM,CAAC,IAAI,EAAE,aAAa,IAAI,MAAM,CAAC,cAAc,CAAC;4BAC3F,kBAAkB,IAAI,oBAAC,WAAW,IAClC,YAAY,EAAG,YAAa,EAC5B,aAAa,EAAG,aAAc,EAC9B,KAAK,EAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EACxB,YAAY,EAAG,IAAI,CAAC,aAAa,EACjC,cAAc,EAAG,IAAI,CAAC,eAAe,EACrC,SAAS,EAAG,IAAI,CAAC,KAAK,CAAC,SAAS,EAChC,cAAc,EAAG,cAAe,EAChC,aAAa,EAAG,aAAc,EAC9B,uBAAuB,EAAG,uBAAwB,EAClD,OAAO,EAAG,OAAQ,EAClB,cAAc,EAAG,cAAc,EAC/B,eAAe,EAAG,eAAgB,EAClC,eAAe,EAAG,IAAI,CAAC,KAAK,CAAC,eAAe,EAC5C,eAAe,EAAG,IAAI,CAAC,KAAK,CAAC,eAAgB,EAC7C,iBAAiB,EAAG,IAAI,CAAC,KAAK,CAAC,iBAAkB,EACjD,qBAAqB,EAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EACxD,OAAO,EAAG,OAAO,EACjB,OAAO,EAAG,OAAO,EACjB,YAAY,EAAG,IAAI,CAAC,KAAK,CAAC,YAAY,EACtC,YAAY,EAAG,IAAI,CAAC,UAAU,GAC9B;4BAGA,oBAAoB,IAAI,oBAAC,aAAa,IACtC,aAAa,EAAG,aAAc,EAC9B,YAAY,EAAG,YAAa,EAC5B,OAAO,EAAG,OAAQ,EAClB,cAAc,EAAG,IAAI,CAAC,eAAe,EACrC,KAAK,EAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EACxB,qBAAqB,EAAG,qBAAsB,EAC9C,sBAAsB,EAAG,sBAAuB,EAChD,cAAc,EAAG,cAAc,EAC/B,eAAe,EAAG,eAAgB,EAClC,iBAAiB,EAAG,IAAI,CAAC,KAAK,CAAC,iBAAkB,EACjD,OAAO,EAAG,OAAO,EACjB,OAAO,EAAG,OAAO,EACjB,YAAY,EAAG,IAAI,CAAC,YAAY,GAChC;4BAEA,aAAa;gCACb,gCACE,IAAI,EAAC,QAAQ,EACb,SAAS,EAAG,GAAG,CAAC,kCAAkC,EAAE,MAAM,CAAC,OAAO,CAAC,EACnE,OAAO,EAAG,IAAI,CAAC,YAAY,EAC3B,SAAS,EAAG,IAAI,CAAC,mBAAmB,EACpC,QAAQ,EAAG,CAAC,IAEV,OAAQ,CAAC,SAAS,CACb,CAEP,CACF,CACF,CACF,CACF,CACP,CAAC;IACJ,CAAC;IAEM,wBAAK,GAAZ;QACE,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE;YAC3B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;SACjC;IACH,CAAC;IAjKa,qBAAY,GAAmB;QAC3C,YAAY,EAAE,SAAS;QACvB,SAAS,EAAE,SAAS;QACpB,oBAAoB,EAAE,IAAI;QAC1B,kBAAkB,EAAE,IAAI;QACxB,wBAAwB,EAAE,KAAK;QAC/B,KAAK,EAAE,SAAS;QAChB,KAAK,EAAE,IAAI,IAAI,EAAE;QACjB,cAAc,EAAE,SAAS,CAAC,MAAM;QAChC,aAAa,EAAE,aAAa,CAAC,GAAG;QAChC,uBAAuB,EAAE,KAAK;QAC9B,aAAa,EAAE,IAAI;QACnB,OAAO,EAAE,IAAI;QACb,qBAAqB,EAAE,KAAK;QAC5B,sBAAsB,EAAE,KAAK;QAC7B,eAAe,EAAE,WAAW;QAC5B,eAAe,EAAE,KAAK;QACtB,eAAe,EAAE,eAAe,CAAC,QAAQ;QACzC,iBAAiB,EAAE,0BAA0B;QAC7C,qBAAqB,EAAE,KAAK;QAC5B,YAAY,EAAE,mBAAmB;KAClC,CAAC;IAkOJ,eAAC;CAAA,AAxPD,CAA8B,aAAa,GAwP1C;SAxPY,QAAQ","sourcesContent":["import * as React from 'react';\r\nimport { ICalendar, ICalendarProps, ICalendarStrings, ICalendarIconStrings, ICalendarFormatDateCallbacks } from './Calendar.types';\r\nimport { DayOfWeek, FirstWeekOfYear, DateRangeType } from '../../utilities/dateValues/DateValues';\r\nimport { CalendarDay, ICalendarDay } from './CalendarDay';\r\nimport { CalendarMonth, ICalendarMonth } from './CalendarMonth';\r\nimport { compareDates, getDateRangeArray } from '../../utilities/dateMath/DateMath';\r\nimport {\r\n  css,\r\n  BaseComponent,\r\n  KeyCodes,\r\n  createRef\r\n} from '../../Utilities';\r\nimport * as stylesImport from './Calendar.scss';\r\nconst styles: any = stylesImport;\r\n\r\nconst leftArrow = 'Up';\r\nconst rightArrow = 'Down';\r\nconst iconStrings: ICalendarIconStrings = {\r\n  leftNavigation: leftArrow,\r\n  rightNavigation: rightArrow\r\n};\r\nconst defaultWorkWeekDays: DayOfWeek[] = [\r\n  DayOfWeek.Monday,\r\n  DayOfWeek.Tuesday,\r\n  DayOfWeek.Wednesday,\r\n  DayOfWeek.Thursday,\r\n  DayOfWeek.Friday,\r\n];\r\n\r\nconst dateTimeFormatterCallbacks: ICalendarFormatDateCallbacks = {\r\n  formatMonthDayYear: (date: Date, strings: ICalendarStrings) => (strings.months[date.getMonth()] + ' ' + date.getDate() + ', ' + date.getFullYear()),\r\n  formatMonthYear: (date: Date, strings: ICalendarStrings) => (strings.months[date.getMonth()] + ' ' + date.getFullYear()),\r\n  formatDay: (date: Date) => date.getDate().toString(),\r\n  formatYear: (date: Date) => date.getFullYear().toString()\r\n};\r\n\r\nexport interface ICalendarState {\r\n  /** The currently focused date in the calendar, but not necessarily selected */\r\n  navigatedDate?: Date;\r\n\r\n  /** The currently selected date in the calendar */\r\n  selectedDate?: Date;\r\n\r\n  /** State used to show/hide month picker */\r\n  isMonthPickerVisible?: boolean;\r\n\r\n  /** State used to show/hide day picker */\r\n  isDayPickerVisible?: boolean;\r\n}\r\n\r\nexport class Calendar extends BaseComponent<ICalendarProps, ICalendarState> implements ICalendar {\r\n  public static defaultProps: ICalendarProps = {\r\n    onSelectDate: undefined,\r\n    onDismiss: undefined,\r\n    isMonthPickerVisible: true,\r\n    isDayPickerVisible: true,\r\n    showMonthPickerAsOverlay: false,\r\n    value: undefined,\r\n    today: new Date(),\r\n    firstDayOfWeek: DayOfWeek.Sunday,\r\n    dateRangeType: DateRangeType.Day,\r\n    autoNavigateOnSelection: false,\r\n    showGoToToday: true,\r\n    strings: null,\r\n    highlightCurrentMonth: false,\r\n    highlightSelectedMonth: false,\r\n    navigationIcons: iconStrings,\r\n    showWeekNumbers: false,\r\n    firstWeekOfYear: FirstWeekOfYear.FirstDay,\r\n    dateTimeFormatter: dateTimeFormatterCallbacks,\r\n    showSixWeeksByDefault: false,\r\n    workWeekDays: defaultWorkWeekDays\r\n  };\r\n\r\n  private _dayPicker = createRef<ICalendarDay>();\r\n  private _monthPicker = createRef<ICalendarMonth>();\r\n\r\n  private _focusOnUpdate: boolean;\r\n\r\n  constructor(props: ICalendarProps) {\r\n    super(props);\r\n    const currentDate = props.value && !isNaN(props.value.getTime()) ? props.value : (props.today || new Date());\r\n\r\n    this.state = {\r\n      selectedDate: currentDate,\r\n      navigatedDate: currentDate,\r\n\r\n      /** When showMonthPickerAsOverlay is active it overrides isMonthPickerVisible/isDayPickerVisible props (These props permanently set the visibility of their respective calendars). */\r\n      isMonthPickerVisible: this.props.showMonthPickerAsOverlay ? false : this.props.isMonthPickerVisible,\r\n      isDayPickerVisible: this.props.showMonthPickerAsOverlay ? true : this.props.isDayPickerVisible\r\n    };\r\n\r\n    this._focusOnUpdate = false;\r\n  }\r\n\r\n  public componentWillReceiveProps(nextProps: ICalendarProps): void {\r\n    const { autoNavigateOnSelection, value, today = new Date() } = nextProps;\r\n\r\n    // Make sure auto-navigation is supported for programmatic changes to selected date, i.e.,\r\n    // if selected date is updated via props, we may need to modify the navigated date\r\n    const overrideNavigatedDate = (autoNavigateOnSelection && !compareDates(value!, this.props.value!));\r\n    if (overrideNavigatedDate) {\r\n      this.setState({\r\n        navigatedDate: value\r\n      });\r\n    }\r\n\r\n    this.setState({\r\n      selectedDate: value || today\r\n    });\r\n  }\r\n\r\n  public componentDidUpdate(): void {\r\n    if (this._focusOnUpdate) {\r\n      // if the day picker is shown, focus on it\r\n      if (this._dayPicker.current) {\r\n        this._dayPicker.current.focus();\r\n      } else if (this._monthPicker.current) {\r\n        this._monthPicker.current.focus();\r\n      }\r\n      this._focusOnUpdate = false;\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const rootClass = 'ms-DatePicker';\r\n    const { firstDayOfWeek, dateRangeType, strings, showMonthPickerAsOverlay, autoNavigateOnSelection, showGoToToday, highlightCurrentMonth, highlightSelectedMonth, navigationIcons, minDate, maxDate, className } = this.props;\r\n    const { selectedDate, navigatedDate, isMonthPickerVisible, isDayPickerVisible } = this.state;\r\n    const onHeaderSelect = showMonthPickerAsOverlay ? this._onHeaderSelect : undefined;\r\n    const monthPickerOnly = !showMonthPickerAsOverlay && !isDayPickerVisible;\r\n    const overlayedWithButton = showMonthPickerAsOverlay && showGoToToday;\r\n\r\n    return (\r\n      <div className={ css(rootClass, styles.root, className) } role='application'>\r\n        <div\r\n          className={ css(\r\n            'ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused',\r\n            styles.picker,\r\n            styles.pickerIsOpened,\r\n            styles.pickerIsFocused,\r\n            isMonthPickerVisible && ('ms-DatePicker-monthPickerVisible ' + styles.monthPickerVisible),\r\n            isMonthPickerVisible && isDayPickerVisible && ('ms-DatePicker-calendarsInline ' + styles.calendarsInline),\r\n            monthPickerOnly && ('ms-DatePicker-monthPickerOnly ' + styles.monthPickerOnly),\r\n            showMonthPickerAsOverlay && ('ms-DatePicker-monthPickerAsOverlay ' + styles.monthPickerAsOverlay),\r\n          ) }\r\n        >\r\n          <div className={ css('ms-DatePicker-holder ms-slideDownIn10', styles.holder, overlayedWithButton && styles.holderWithButton) } onKeyDown={ this._onDatePickerPopupKeyDown }>\r\n            <div className={ css('ms-DatePicker-frame', styles.frame) }>\r\n              <div className={ css('ms-DatePicker-wrap', styles.wrap, showGoToToday && styles.goTodaySpacing) }>\r\n                { isDayPickerVisible && <CalendarDay\r\n                  selectedDate={ selectedDate! }\r\n                  navigatedDate={ navigatedDate! }\r\n                  today={ this.props.today }\r\n                  onSelectDate={ this._onSelectDate }\r\n                  onNavigateDate={ this._onNavigateDate }\r\n                  onDismiss={ this.props.onDismiss }\r\n                  firstDayOfWeek={ firstDayOfWeek! }\r\n                  dateRangeType={ dateRangeType! }\r\n                  autoNavigateOnSelection={ autoNavigateOnSelection! }\r\n                  strings={ strings! }\r\n                  onHeaderSelect={ onHeaderSelect }\r\n                  navigationIcons={ navigationIcons! }\r\n                  showWeekNumbers={ this.props.showWeekNumbers }\r\n                  firstWeekOfYear={ this.props.firstWeekOfYear! }\r\n                  dateTimeFormatter={ this.props.dateTimeFormatter! }\r\n                  showSixWeeksByDefault={ this.props.showSixWeeksByDefault }\r\n                  minDate={ minDate }\r\n                  maxDate={ maxDate }\r\n                  workWeekDays={ this.props.workWeekDays }\r\n                  componentRef={ this._dayPicker }\r\n                />\r\n                }\r\n\r\n                { isMonthPickerVisible && <CalendarMonth\r\n                  navigatedDate={ navigatedDate! }\r\n                  selectedDate={ selectedDate! }\r\n                  strings={ strings! }\r\n                  onNavigateDate={ this._onNavigateDate }\r\n                  today={ this.props.today }\r\n                  highlightCurrentMonth={ highlightCurrentMonth! }\r\n                  highlightSelectedMonth={ highlightSelectedMonth! }\r\n                  onHeaderSelect={ onHeaderSelect }\r\n                  navigationIcons={ navigationIcons! }\r\n                  dateTimeFormatter={ this.props.dateTimeFormatter! }\r\n                  minDate={ minDate }\r\n                  maxDate={ maxDate }\r\n                  componentRef={ this._monthPicker }\r\n                /> }\r\n\r\n                { showGoToToday &&\r\n                  <button\r\n                    role='button'\r\n                    className={ css('ms-DatePicker-goToday js-goToday', styles.goToday) }\r\n                    onClick={ this._onGotoToday }\r\n                    onKeyDown={ this._onGotoTodayKeyDown }\r\n                    tabIndex={ 0 }\r\n                  >\r\n                    { strings!.goToToday }\r\n                  </button>\r\n                }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public focus() {\r\n    if (this._dayPicker.current) {\r\n      this._dayPicker.current.focus();\r\n    }\r\n  }\r\n\r\n  private _navigateDay = (date: Date): void => {\r\n    this.setState({\r\n      navigatedDate: date\r\n    });\r\n  }\r\n\r\n  private _onNavigateDate = (date: Date, focusOnNavigatedDay: boolean): void => {\r\n    if (this.props.isDayPickerVisible || (!this.props.isDayPickerVisible && !focusOnNavigatedDay)) {\r\n      this._navigateDay(date);\r\n      this._focusOnUpdate = focusOnNavigatedDay;\r\n    } else {\r\n      // if only the month picker is shown, select the chosen month\r\n      this._onSelectDate(date);\r\n    }\r\n  }\r\n\r\n  private _onSelectDate = (date: Date, selectedDateRangeArray?: Date[]): void => {\r\n    const { onSelectDate } = this.props;\r\n\r\n    this.setState({\r\n      selectedDate: date\r\n    });\r\n\r\n    if (onSelectDate) {\r\n      onSelectDate(date, selectedDateRangeArray);\r\n    }\r\n  }\r\n\r\n  private _onHeaderSelect = (focus: boolean): void => {\r\n    this.setState({\r\n      isDayPickerVisible: !this.state.isDayPickerVisible,\r\n      isMonthPickerVisible: !this.state.isMonthPickerVisible\r\n    });\r\n\r\n    if (focus) {\r\n      this._focusOnUpdate = true;\r\n    }\r\n  }\r\n\r\n  private _onGotoToday = (): void => {\r\n    const { dateRangeType, firstDayOfWeek, today, workWeekDays } = this.props;\r\n\r\n    const dates = getDateRangeArray(today!, dateRangeType!, firstDayOfWeek!, workWeekDays!);\r\n\r\n    this._onSelectDate(today!, dates);\r\n  }\r\n\r\n  private _onGotoTodayKeyDown = (ev: React.KeyboardEvent<HTMLElement>): void => {\r\n    if (ev.which === KeyCodes.enter) {\r\n      ev.preventDefault();\r\n      this._onGotoToday();\r\n    } else if (ev.which === KeyCodes.tab && !ev.shiftKey) {\r\n      if (this.props.onDismiss) {\r\n        ev.stopPropagation();\r\n        ev.preventDefault();\r\n        this.props.onDismiss();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _onDatePickerPopupKeyDown = (ev: React.KeyboardEvent<HTMLElement>): void => {\r\n    switch (ev.which) {\r\n      case KeyCodes.enter:\r\n        ev.preventDefault();\r\n        break;\r\n\r\n      case KeyCodes.backspace:\r\n        ev.preventDefault();\r\n        break;\r\n\r\n      case KeyCodes.escape:\r\n        this._handleEscKey(ev);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  private _handleEscKey = (ev: React.KeyboardEvent<HTMLElement>): void => {\r\n    if (this.props.onDismiss) {\r\n      this.props.onDismiss();\r\n    }\r\n  }\r\n}\r\n"]}